(()=>{var e={};e.id=928,e.ids=[928],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5651:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>c,routeModule:()=>h,tree:()=>u});var s=r(482),a=r(9108),n=r(2563),l=r.n(n),i=r(8300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let u=["",{children:["test",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8482)),"/home/admin/openclaw/workspace/trip-splitter/src/app/test/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,3597)),"/home/admin/openclaw/workspace/trip-splitter/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/home/admin/openclaw/workspace/trip-splitter/src/app/test/page.tsx"],d="/test/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/test/page",pathname:"/test",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},4569:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},8940:(e,t,r)=>{Promise.resolve().then(r.bind(r,9886))},1334:(e,t,r)=>{Promise.resolve().then(r.bind(r,830))},830:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5344),a=r(3729),n=r(9886),l=r(8704);function i(){let{user:e,profile:t,loading:r,signIn:i,signOut:o}=(0,n.useAuth)(),[u,c]=(0,a.useState)(""),[d,p]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),x=async()=>{m("测试登录中...");let e=await i(u,d);m(e.success?"✅ 登录成功！":`❌ 失败：${e.error}`)},g=async()=>{m("测试注册中...");let{signUp:e}=(0,n.useAuth)(),t=await e(u,d);m(t.success?"✅ 注册成功！请检查邮箱":`❌ 失败：${t.error}`)};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 p-8",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto bg-white rounded-2xl shadow-xl p-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"\uD83D\uDD27 Supabase 连接测试"}),(0,s.jsxs)("div",{className:`p-4 rounded-xl mb-6 ${l.j?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[s.jsx("p",{className:"text-lg font-semibold mb-2",children:l.j?"✅ Supabase 已配置":"❌ Supabase 未配置"}),s.jsx("p",{className:"text-sm text-gray-600",children:l.j?"URL: https://zrbcxtamglfjarupqkic.supabase.co":"请检查 .env.local 文件"})]}),(0,s.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl mb-6",children:[s.jsx("p",{className:"text-lg font-semibold mb-2",children:"\uD83D\uDC64 用户状态"}),r?s.jsx("p",{className:"text-gray-600",children:"加载中..."}):e?(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-green-700",children:"✅ 已登录"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["邮箱：",e.email]}),t&&(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["姓名：",t.full_name||"未设置"]}),s.jsx("button",{onClick:async()=>{await o(),m("✅ 已退出登录")},className:"mt-3 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition",children:"退出登录"})]}):s.jsx("p",{className:"text-gray-600",children:"❌ 未登录"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"测试登录/注册"}),s.jsx("input",{type:"email",value:u,onChange:e=>c(e.target.value),placeholder:"测试邮箱",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),s.jsx("input",{type:"password",value:d,onChange:e=>p(e.target.value),placeholder:"测试密码（至少 6 位）",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition",children:"测试登录"}),s.jsx("button",{onClick:g,className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition",children:"测试注册"})]}),h&&s.jsx("div",{className:`p-4 rounded-lg ${h.includes("✅")?"bg-green-50 text-green-700":h.includes("❌")?"bg-red-50 text-red-700":"bg-blue-50 text-blue-700"}`,children:h})]}),(0,s.jsxs)("div",{className:"mt-8 pt-6 border-t",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"\uD83D\uDD17 快速链接"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[s.jsx("a",{href:"https://supabase.com/dashboard/project/zrbcxtamglfjarupqkic",target:"_blank",className:"block text-indigo-600 hover:underline",children:"→ Supabase Dashboard"}),s.jsx("a",{href:"https://supabase.com/dashboard/project/zrbcxtamglfjarupqkic/auth/users",target:"_blank",className:"block text-indigo-600 hover:underline",children:"→ 用户管理"}),s.jsx("a",{href:"/",className:"block text-indigo-600 hover:underline",children:"→ 返回主页"})]})]})]})})}},8704:(e,t,r)=>{"use strict";r.d(t,{O:()=>i,j:()=>l});var s=r(7635);let a="https://zrbcxtamglfjarupqkic.supabase.co",n="sb_publishable_B9aae0u1JmEcOybu_E409Q_Z2r9GkDt",l=!!a&&!!n,i=l?(0,s.eI)(a,n):{auth:{getUser:async()=>({data:{user:null},error:null}),getSession:async()=>({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}}),signUp:async()=>({data:null,error:{message:"Supabase not configured"}}),signInWithPassword:async()=>({data:null,error:{message:"Supabase not configured"}}),signOut:async()=>({error:null})},from:()=>({select:()=>({eq:()=>Promise.resolve({data:[],error:null}),insert:()=>Promise.resolve({data:null,error:null}),update:()=>Promise.resolve({data:null,error:null}),delete:()=>Promise.resolve({data:null,error:null})})})}},9886:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthProvider:()=>c,useAuth:()=>d});var s=r(5344),a=r(3729),n=r(8704);async function l(){try{let{error:e}=await n.O.auth.signOut();if(e)throw e;return{success:!0}}catch(e){return{success:!1,error:e.message}}}async function i(){try{let{data:{user:e}}=await n.O.auth.getUser();return e}catch{return null}}async function o(){try{let e=await i();if(!e)return null;let{data:t}=await n.O.from("profiles").select("*").eq("id",e.id).single();return t}catch{return null}}let u=(0,a.createContext)(void 0);function c({children:e}){let[t,r]=(0,a.useState)(null),[i,c]=(0,a.useState)(null),[d,p]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=!0,t=setTimeout(()=>{e&&d&&(console.warn("[Auth] Loading timeout, forcing state update"),p(!1))},5e3);n.O.auth.getSession().then(({data:s,error:a})=>{if(!e)return;clearTimeout(t),a&&console.error("Session error:",a);let n=s.session?.user||null;console.log("[Auth] Initial session:",n?{email:n.email,id:n.id}:"null"),r(n),p(!1),n&&o().then(c).catch(console.error)}).catch(r=>{e&&(clearTimeout(t),console.error("getSession failed:",r),p(!1))});let{data:{subscription:s}}=n.O.auth.onAuthStateChange(async(t,s)=>{e&&(console.log("[Auth] State change:",t,s?.user?.email),r(s?.user||null),s?.user?c(await o()):c(null),p(!1))});return()=>{e=!1,clearTimeout(t),s.unsubscribe()}},[]);let h=async(e,t)=>{let{data:s,error:a}=await n.O.auth.signInWithPassword({email:e,password:t});return a?{success:!1,error:a.message}:(r(s.user),{success:!0})},m=async(e,t,s)=>{let{data:a,error:l}=await n.O.auth.signUp({email:e,password:t,options:{data:{full_name:s}}});return l?{success:!1,error:l.message}:(r(a.user),{success:!0})},x=async()=>{await l(),r(null),c(null)};return s.jsx(u.Provider,{value:{user:t,profile:i,loading:d,signIn:h,signUp:m,signOut:x},children:e})}function d(){let e=(0,a.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3597:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>u});var s=r(5036);r(5023);var a=r(6843);let n=(0,a.createProxy)(String.raw`/home/admin/openclaw/workspace/trip-splitter/src/lib/use-auth.tsx`),{__esModule:l,$$typeof:i}=n;n.default;let o=(0,a.createProxy)(String.raw`/home/admin/openclaw/workspace/trip-splitter/src/lib/use-auth.tsx#AuthProvider`);(0,a.createProxy)(String.raw`/home/admin/openclaw/workspace/trip-splitter/src/lib/use-auth.tsx#useAuth`);let u={title:"Trip Splitter - 旅游分账",description:"支持 Family 维度聚合结算的旅游分账工具"};function c({children:e}){return s.jsx("html",{lang:"zh-CN",children:s.jsx("body",{className:"antialiased",children:s.jsx(o,{children:e})})})}},8482:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});let s=(0,r(6843).createProxy)(String.raw`/home/admin/openclaw/workspace/trip-splitter/src/app/test/page.tsx`),{__esModule:a,$$typeof:n}=s,l=s.default},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[147],()=>r(5651));module.exports=s})();